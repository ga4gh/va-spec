$schema: "https://json-schema.org/draft/2020-12/schema"
$id: "https://w3id.org/ga4gh/schema/va-spec/1.x/profiles/profiles-source.yaml"
title: VA Spec Standard Profiles
strict: true

imports:
  va.core: ../core-im/core-im-source.yaml
  catvrs: ../../catvrs/catvrs-source.yaml
  gks.core: ../../gks-core-im/core-im-source.yaml
  gks.domain-entities: ../../gks-domain-entities/domain-entities-source.yaml
  vrs: ../../vrs/vrs-source.yaml

namespaces:
  va.core: ../core-im/core-im.json#/$defs/
  gks.core: ../../gks-core-im/core-im.json#/$defs/
  gks.domain-entities: ../../gks-domain-entities/domain-entities.json#/$defs/
  catvrs: ../../catvrs/catvrs.json#/$defs/
  vrs: ../../vrs/vrs.json#/$defs/

$defs:
  CohortAlleleFrequency:
    inherits: gks.core:InformationEntity
    maturity: draft
    type: object
    description: >-
      A measure of the frequency of an Allele in a cohort.
    properties:
      derivedFrom:
        type: object
        description: Information about the dataset from which the CohortAlleleFrequency was reported.
        properties:
          id:
            type: string
            description: The identifier of the dataset.
          type:
            type: string
            description: The type of the dataset. (e.g. "DataSet")
          label:
            type: string
            description: A descriptive label for the dataset.
          version:
            type: string
            description: The version of the dataset.
        additionalProperties: false
      focusAllele:
        oneOf:
          - $refCurie: vrs:Allele
          - type: string
            format: uri-reference
        description: The Allele for which the frequency is being reported.
      focusAlleleCount:
        type: integer
        description: The number of occurrences of the focusAllele in the cohort.
      locusAlleleCount:
        type: integer
        description: >-
          The number of occurrences of alleles at the locus in the cohort
          (count of all alleles at this locus, sometimes referred to as "allele number").
      alleleFrequency:
        type: number
        description: The frequency of the focusAllele in the cohort.
      cohort:
        type: object
        properties:
          id:
            type: string
          label:
            type: string
          characteristics:
            type: array
            items:
              type: object
              properties:
                name:
                  type: string
                value:
                  type: string
              required:
                - name
                - value
              additionalProperties: false
        additionalProperties: false
        required:
          - id
        description: >-
          The cohort from which the frequency was derived.
      ancillaryResults:
        maturity: draft
        $comment: This field is different from most GKS objects by allowing any content to be added, and so is independently versioned.
        type: object
        additionalProperties: true
        description: >-
          Ancillary results that may be associated with the CohortAlleleFrequency,
          providing additional context or information.
      qualityMeasures:
        maturity: draft
        $comment: This field is different from most GKS objects by allowing any content to be added, and so is independently versioned.
        type: object
        additionalProperties: true
        description: >-
          Quality measures associated with the CohortAlleleFrequency and how it was
          derived, which may impact interpretation.
      subcohortFrequency:
        type: array
        ordered: false
        items:
          $ref: "#/$defs/CohortAlleleFrequency"
        description: >-
          A list of CohortAlleleFrequency objects describing subcohorts of the cohort currently being described.
          This creates a recursive relationship and subcohorts can be further subdivided into more subcohorts.
          This enables, for example, the description of different ancestry groups and sexes among those ancestry groups.
    required: [focusAllele, focusAlleleCount, locusAlleleCount, alleleFrequency, cohort]
    additionalProperties: false

# Variant Statement abstractions for variant statement subclasses
  VariantStatement:
    inherits: va.core:Statement
    description: >-
      A :ref:`Statement` describing the impact of a variant.
    heritableProperties:
      variant:
        extends: subject
        oneOf:
          - $refCurie: vrs:Variation
          - $refCurie: catvrs:CategoricalVariation
          - $refCurie: gks.core:IRI
        description: A variant that is the subject of the Statement.

  VariantClassification:
    inherits: VariantStatement
    description: >-
      A :ref:`VariantStatement` classifying the impact of a variant.
    heritableProperties:
      classification:
        extends: subjectClassification
        oneOf:
          - $refCurie: gks.core:Coding
          - $refCurie: gks.core:IRI
        description: >-
          A methodological, summary classification about the impact of a variant.
    heritableRequired:
      - classification

  VariantStudySummary:
    inherits: VariantStatement
    description: >-
      A :ref:`Statement` summarizing evidence about the impact of a variant from
      one or more studies.
    heritableProperties:
      isReportedIn:
        extends: isReportedIn
        minItems: 1
    heritableRequired:
      - isReportedIn

# Variant Diagnostic Study Statement
  VariantDiagnosticStudy:
    inherits: VariantStudySummary
    type: object
    maturity: draft
    description: >-
      A study summarization describing whether a variant is associated with a disease
      (positive) or lack of a disease (negative).
    properties:
      type:
        type: string
        const: "VariantDiagnosticStudy"
        default: "VariantDiagnosticStudy"
        description: MUST be "VariantDiagnosticStudy".
      predicate:
        extends: predicate
        enum:
          - positive
          - negative
      disease:
        extends: object
        oneOf:
          - $refCurie: gks.domain-entities:Condition
          - $refCurie: gks.core:IRI
        description: The disease that is evaluated for diagnosis.
      qualifiers:
        extends: qualifiers
        properties:
          alleleOrigin:
            type: string
            description: >-
              Whether the statement should be interpreted in the context of an inherited
              (germline) variant, an acquired (somatic) mutation, or both (combined).
            enum:
              - germline
              - somatic
              - combined
          allelePrevalence:
            type: string
            description: >-
              Whether the statement should be interpreted in the context of the variant
              being rare or common.
            enum:
              - rare
              - common
          geneContext:
            description: A gene context that qualifies the Statement.
            $refCurie: gks.domain-entities:Gene
    required:
      - disease
      - predicate

# Variant Oncogenicity Study Statement
  VariantOncogenicityStudy:
    inherits: VariantStudySummary
    maturity: draft
    type: object
    description: >-
      A study summarization supporting or refuting the effect of variant on oncogenesis of a tumor type.
    properties:
      type:
        type: string
        const: "VariantOncogenicity"
        default: "VariantOncogenicity"
        description: MUST be "VariantOncogenicity".
      predicate:
        extends: predicate
        enum:
          - isOncogenicFor
          - isProtectiveFor
          - isPredisposingFor
      tumorType:
        extends: object
        oneOf:
          - $refCurie: gks.domain-entities:Condition
          - $refCurie: gks.core:IRI
        description: >-
          The tumor type for which the variant impact is evaluated.
      qualifiers:
        extends: qualifiers
        properties:
          alleleOrigin:
            type: string
            description: >-
              Whether the statement should be interpreted in the context of an inherited 
              (germline) variant, an acquired (somatic) mutation, or both (combined).
            enum:
              - germline
              - somatic
              - combined
          allelePrevalence:
            type: string
            description: >-
              Whether the statement should be interpreted in the context of the variant
              being rare or common.
            enum:
              - rare
              - common
          geneContext:
            description: >-
              A gene context that qualifies the Statement.
            $refCurie: gks.domain-entities:Gene
    required:
      - tumorType
      - predicate

# Variant Pathogenicity Statement
  VariantPathogenicity:
    type: object
    maturity: draft
    inherits: VariantClassification
    description: >-
      A :ref:`VariantClassification` describing the role of a variant in causing an 
      inherited disorder.
    properties:
      type:
        type: string
        const: "VariantPathogenicity"
        default: "VariantPathogenicity"
        description: MUST be "VariantPathogenicity".
      predicate:
        extends: predicate
        const: isCausalFor
      condition:
        extends: object
        oneOf:
          - $refCurie: gks.domain-entities:Condition
          - $refCurie: gks.core:IRI
        description: The :ref:`Condition` for which the variant impact is stated.
      qualifiers:
        extends: qualifiers
        properties:
          penetrance:
            type: string
            enum:
              - high
              - low
              - risk allele
            description: >-
              The extent to which the variant impact is expressed by individuals carrying it as
              a measure of the proportion of carriers exhibiting the condition.
          modeOfInheritance:
            type: string
            enum:
              - autosomal dominant
              - autosomal recessive
              - X-linked dominant
              - X-linked recessive
              - mitochondrial
            description: >-
              The pattern of inheritance expected for the pathogenic effect of this variant.
          geneContext:
            description: A gene context that qualifies the Statement.
            $refCurie: gks.domain-entities:Gene
    required:
      - condition

# Variant Prognostic Study Statement
  VariantPrognosticStudy:
    inherits: VariantStudySummary
    type: object
    maturity: draft
    description: >-
      A study summarization describing whether a variant is associated with improved or
      worse outcome for a disease.
    properties:
      type:
        type: string
        const: "VariantPrognosticStudy"
        default: "VariantPrognosticStudy"
        description: MUST be "VariantPrognosticStudy".
      predicate:
        extends: predicate
        enum:
          - Better Outcome
          - Worse Outcome
      disease:
        extends: object
        oneOf:
          - $refCurie: gks.domain-entities:Condition
          - $refCurie: gks.core:IRI
        description: The disease that is evaluated for outcome.
      qualifiers:
        extends: qualifiers
        properties:
          alleleOrigin:
            type: string
            description: >-
              Whether the statement should be interpreted in the context of an inherited
              (germline) variant, an acquired (somatic) mutation, or both (combined).
            enum:
              - germline
              - somatic
              - combined
          allelePrevalence:
            type: string
            description: >-
              Whether the statement should be interpreted in the context of the variant
              being rare or common.
            enum:
              - rare
              - common
          geneContext:
            description: A gene context that qualifies the Statement.
            $refCurie: gks.domain-entities:Gene
    required:
      - disease
      - predicate

# Variant Therapeutic Response Study Statement
  VariantTherapeuticResponseStudy:
    inherits: VariantStudySummary
    maturity: draft
    type: object
    description: >-
      A study summarization describing the role of a variant in modulating the response of a
      neoplasm to drug administration or other therapeutic procedure.
    properties:
      type:
        type: string
        const: "VariantTherapeuticResponseStudy"
        default: "VariantTherapeuticResponseStudy"
        description: MUST be "VariantTherapeuticResponseStudy".
      predicate:
        extends: predicate
        enum:
          - predictsSensitivityTo
          - predictsResistanceTo
      therapeutic:
        description: A drug administration or other therapeutic procedure that the neoplasm
          is intended to respond to.
        extends: object
        oneOf:
          - $refCurie: gks.domain-entities:TherapeuticProcedure
          - $refCurie: gks.core:IRI
      disease:
        oneOf:
          - $refCurie: gks.domain-entities:Condition
          - $refCurie: gks.core:IRI
        description: The disease context in which the variant impact is evaluated.
      qualifiers:
        extends: qualifiers
        properties:
          alleleOrigin:
            type: string
            description: >-
              Whether the statement should be interpreted in the context of an inherited
              (germline) variant, an acquired (somatic) mutation, or both (combined).
            enum:
              - germline
              - somatic
              - combined
          allelePrevalence:
            type: string
            description: >-
              Whether the statement should be interpreted in the context of the variant
              being rare or common.
            enum:
              - rare
              - common
          geneContext:
            description: A gene context that qualifies the Statement.
            $refCurie: gks.domain-entities:Gene
    required:
      - disease
      - predicate
      - therapeutic